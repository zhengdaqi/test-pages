(function(){var e=function(){var k=g();var q=i();var p=a();var r=d();var v=b();if((typeof WEBNOTES=="undefined"&&typeof v.WEBNOTES=="undefined"&&typeof __wn_usingBookmarklet=="undefined")||window.__wn_forceReload||q||(k&&!p)){if(!v.body){alert("Oops!  Please wait for the page to finish loading, then try running WebNotes again.");return}c().__wn_usingBookmarklet=true;var m="http://www.webnotes.net/engine";if(location.protocol=="https:"){m=m.replace("http://","https://")}if(!v.getElementById("__wn_loadingMsg")&&(!k||q)){var o=v.createElement("div");o.id="__wn_loadingMsg";o.innerHTML="Loading...";if(f()){o.style.position="fixed"}else{o.style.position="absolute"}o.style.top=0;o.style.right=0;o.style.padding="4px 8px 4px 24px";o.style.width="auto";o.style.margin="4px";o.style.zIndex=2147400500;o.style.border="solid 1px #CCCCCC";o.style.color="#ffffff";o.style.font="10pt arial,helvetica,tahoma";o.style.background="#CC3333 url("+m+"/res/spinner.gif) no-repeat scroll 4px center";if(v.getElementsByTagName("head").item(0)){v.body.appendChild(o)}}var n="2.0.1.7414";var w=v.createElement("script");w.charset="Unicode-UTF-8";w.type="text/javascript";if(k&&!q&&!r){w.src=m+"/scripts/Loader.js?v="+n+"&b=1";w.id="__wn_loaderjs"}else{if(!p){w.src=m+"/scripts/WebNotes.js?v="+n+"&b=1";w.id="__wn_webnotesjs"}}if(v.getElementsByTagName("head").item(0)){v.getElementsByTagName("head").item(0).appendChild(w)}else{v.body.appendChild(w)}j(m+"/css/WebNotes.css?v="+n);j(m+"/css/Bookmarklet.css?v="+n);var u=new Image();u.src=m+"/res/toolbar.png?v="+n;var t=new Image();t.src=m+"/res/spinner2.gif?v="+n}else{if(typeof c().__wn_usingBookmarklet=="undefined"||c().__wn_usingBookmarklet==false){if(location.host.match(/share.*\.webnotes\.net$/)){alert("The WebNotes bookmarklet cannot be run on shared pages.")}else{if(location.href.match(/webnotes.net\/MyWebNotes\/Explorer.aspx/i)){alert("The WebNotes bookmarklet cannot be run on the Organizer page.")}else{if(location.href.match(/webnotes.net\/MyWebNotes\/UploadPDF.aspx/i)){alert("The WebNotes bookmarklet cannot be run on the PDF Upload page.")}else{alert("The WebNotes bookmarklet cannot be run at the same time as the WebNotes Toolbar.")}}}}else{alert("The WebNotes bookmarklet has already been loaded!")}}};function g(){var k=document;if(k.getElementById("__wn_usingChromeToolbar")){return true}if(k.getElementById("__wn_bootstrapper")&&k.getElementById("__wn_bootstrapper").getAttribute("src").indexOf("ischrome=true")!=-1){return true}return false}function d(){var k=b();var l=k.getElementById("__wn_loaderjs");if(l){return true}return false}function a(){var l=b();var k=l.getElementById("__wn_webnotesjs");if(k){return true}return false}function i(){var l=document;var k=l.getElementById("__wn_usingChromeToolbar");if(k){if(k.getAttribute("isManual")==="true"){return true}}return false}function j(k){var l=b();var m=l.createElement("link");m.rel="stylesheet";m.href=k;if(l.getElementsByTagName("head").item(0)){l.getElementsByTagName("head").item(0).appendChild(m)}else{l.body.appendChild(m)}}function h(){var m=document.getElementById("__wn_targetframe");if(m){return m}var p=document.getElementsByTagName("frameset");if(p.length==0){return null}else{function o(A){var D=[];var w=A.getElementsByTagName("frame");for(var v=0;v<w.length;v++){var u=w[v];D.push(u);var y=null;try{y=u.contentWindow.document}catch(z){}if(y){var C=o(y);for(var B=0;B<C.length;B++){D.push(C[B])}}}return D}var r=o(document);var t=0;var s=null;for(var n=0;n<r.length;n++){var l=r[n];try{var k=l.offsetWidth*l.offsetHeight;if(k>t){if(l.contentWindow.document.getElementsByTagName("frameset").length==0){s=l;t=k}}}catch(q){}}return s}}function c(){var n=h();if(n==null){return window}else{var m=(n)?n.contentWindow:window;try{var l=m.document;return m}catch(k){alert("Sorry, this page is not compatible with WebNotes.")}}}function b(){var l=c();var k=l.document;return k}function f(){try{var p=false;var m=document.documentElement&&typeof document.documentElement.style.maxHeight!="undefined";var l=document.compatMode&&document.all;var k=document.all;var o="unknown";if(document.compatMode){if(document.compatMode=="BackCompat"){o="quirks"}else{if(document.compatMode=="CSS1Compat"){o="standards compliant"}else{o="almost standards compliant"}}}if(!k){p=true}else{if(m&&o=="standards compliant"){p=true}}}catch(n){p=false}return p}e()})();